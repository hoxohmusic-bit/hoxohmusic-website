<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>TIEMPO TROPICAL – RITMO INMORTAL – HOXOH MUSIC</title>
<meta content="Álbum TIEMPO TROPICAL – RITMO INMORTAL de HOXOH." name="description"/>
<meta content="TIEMPO TROPICAL – RITMO INMORTAL – HOXOH MUSIC" property="og:title"/>
<meta content="Álbum TIEMPO TROPICAL – RITMO INMORTAL de HOXOH." property="og:description"/>
<meta content="website" property="og:type"/>
<meta content="assets/covers/album-tiempo-tropical-ritmo-inmortal-cover.jpg" property="og:image"/>
<meta content="#0b0b0b" name="theme-color"/>
<!-- Favicons -->
<link href="assets/favicon/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="assets/favicon/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="assets/favicon/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="assets/favicon/site.webmanifest" rel="manifest"/>
<link href="assets/favicon/favicon.ico" rel="icon" type="image/x-icon"/>
<!-- Globale Styles -->
<link href="style.css" rel="stylesheet">
<!-- Seitenspezifische Styles -->
<style>
    .album-detail{
      display:grid;
      grid-template-columns: 520px 1fr;
      gap:36px;
      align-items:start;
      margin:28px auto 34px;
      max-width:1200px;
      padding:0 22px;
    }
    .album-detail .left-col .cover{
      width:100%; height:auto; display:block;
      border-radius:14px; box-shadow:var(--shadow);
    }

    /* Provider-Kacheln: 5 nebeneinander in einer Reihe, große Icons */
    .album-detail .left-col .streaming-grid{
      width:100%; margin-top:18px;
      display:grid; grid-template-columns:repeat(5, 1fr); gap:12px;
    }
    .album-detail .provider-tile{
      background:#1c2026; border:1px solid rgba(255,255,255,.08);
      border-radius:12px; aspect-ratio:1/1;
      display:grid; place-items:center; text-decoration:none;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .album-detail .provider-tile img{ 
      width:95% !important; 
      height:auto !important; 
      display:block !important; 
      max-width:95% !important;
    }

    .album-detail .left-col .intro{
      margin-top:16px; color:#cdd6dd; line-height:1.55;
    }

    .album-detail h1{
      margin:0 0 12px; font-size:32px; font-weight:900; letter-spacing:.02em;
    }
    .album-detail .meta-row{
      display:flex; align-items:center; gap:10px; margin:0 0 12px;
    }
    .album-detail .pill{
      background:#20242a; color:#a6b0b8;
      height:32px; padding:0 14px; border-radius:999px;
      display:inline-flex; align-items:center; font-size:14px; white-space:nowrap;
    }
    .album-detail .pill.explicit{ font-weight:800; letter-spacing:.06em; }

    .album-detail .tracklist{ list-style:none; margin:0; padding:0; display:grid; gap:12px; }
    .album-detail .track{
      background:#1a1e23; border:1px solid #262c34; color:#e6edf3;
      border-radius:14px; padding:12px 12px 12px 16px;
      display:grid; grid-template-columns: 2fr 1fr; gap:12px; align-items:center;
    }
    .album-detail .t-left{ display:flex; align-items:center; gap:10px; min-width:0; }
    .album-detail .t-left .no{
      flex:0 0 auto; font-weight:800; color:#dce6ee; width:40px; text-align:left;
    }
    .album-detail .t-left .name{
      min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      letter-spacing:.01em;
    }
    .album-detail .t-left .explicit-chip{
      margin-left:8px;
      height:22px; padding:0 9px;
      display:inline-flex; align-items:center;
      border-radius:999px; font-size:12px;
      background:#20242a; color:#cfd7df;
      border:1px solid rgba(255,255,255,.1);
      white-space:nowrap;
    }

    .album-detail .t-audio audio{ width:100%; display:block; }
    .album-detail .back{
      display:inline-block; margin-top:18px;
      background:#19c37d; color:#05261b; font-weight:800;
      padding:10px 16px; border-radius:12px; text-decoration:none;
    }

    .site-header .brand img{ height:42px; width:auto; display:block; }

    @media (max-width: 900px){
      .album-detail{ grid-template-columns:1fr; }
    }
    @media (max-width: 760px){
      .album-detail .track{ grid-template-columns:1fr; }
      .album-detail .t-left .no{ width:auto; }
    }
    @media (max-width: 620px){
      .album-detail .left-col .streaming-grid{ grid-template-columns:repeat(3,1fr); }
    }
  </style>
</link><style>
.album-detail .left-col .cover{transition:opacity .25s ease}
.album-detail .left-col .cover.is-swapping{opacity:0}
</style></head>
<body>
<header class="site-header">
<div class="container header-inner">
<a aria-label="HOXOH MUSIC" class="brand" href="index.html">
<img alt="HOXOH MUSIC" height="62" src="assets/logo/hoxoh-music-header-239x62.png" srcset="assets/logo/hoxoh-music-header-239x62.png 1x,
                  assets/logo/hoxoh-music-header-478x124.png 2x" width="239"/>
</a>
<nav aria-label="Navegación principal" class="main-nav">
<a class="nav-link" href="index.html">Inicio</a>
<a class="nav-link active" href="albums.html">Álbumes</a>
<a class="nav-link" href="kontakt.html">Contacto</a>
</nav>
<div class="lang" id="lang">
<button aria-expanded="false" aria-haspopup="listbox" class="lang-btn" type="button">ES ▾</button>
<ul aria-label="Idiomas" class="lang-menu" role="listbox">
<li><a class="active-lang" href="album-tiempo-tropical-ritmo-inmortal.html" hreflang="es">ES</a></li>
<li><a href="album-tiempo-tropical-ritmo-inmortal-de.html" hreflang="de">DE</a></li>
<li><a href="album-tiempo-tropical-ritmo-inmortal-en.html" hreflang="en">EN</a></li>
</ul>
</div>
</div>
</header>
<main>
<article class="album-detail">
<div class="left-col">
<img alt="TIEMPO TROPICAL – RITMO INMORTAL cover" class="cover" loading="lazy" src="assets/covers/album-tiempo-tropical-ritmo-inmortal-cover.jpg">
<div aria-label="Plataformas de streaming" class="streaming-grid">
<a aria-label="Spotify" class="provider-tile" href="#" target="_blank" rel="noopener">
<img alt="" src="assets/provider_icons/spotify-icon.png"/>
</a>
<a aria-label="Apple Music" class="provider-tile" href="#" target="_blank" rel="noopener">
<img alt="" src="assets/provider_icons/apple-music-icon.png"/>
</a>
<a aria-label="YouTube Music" class="provider-tile" href="#" target="_blank" rel="noopener">
<img alt="" src="assets/provider_icons/youtube-music-icon.png"/>
</a>
<a aria-label="TIDAL" class="provider-tile" href="#" target="_blank" rel="noopener">
<img alt="" src="assets/provider_icons/tidal-icon.png"/>
</a>
<a aria-label="Amazon Music" class="provider-tile" href="#" target="_blank">
<img alt="" src="assets/provider_icons/amazon-music-icon1.png"/>
</a>
</div>
<p class="intro">
<p style="text-align:justify;">
<b>TIEMPO TROPICAL</b> es un álbum conceptual que catapulta a los grandes compositores clásicos al mundo de la música latina moderna. Fusiona la genialidad de maestros como Beethoven y Mozart con ritmos enérgicos como el reggaeton, la salsa, la cumbia y la bachata. Cada canción toma una obra famosa y la transforma en un éxito bailable y moderno.
</p>
<p style="text-align:justify;">
El viaje musical comienza con la 5ª Sinfonía de Beethoven como un éxito de reggaeton y las melodías de Mozart fusionadas con cumbia. Las fugas de Bach se convierten en una fiesta de salsa, mientras que la "Sinfonía Sorpresa" de Haydn se transforma en una divertida mezcla de techno y salsa. "Las Cuatro Estaciones" de Vivaldi se convierten en un tema de dancehall, y el romanticismo de Chopin en una bachata apasionada. El virtuosismo del violín de Paganini se encuentra con el merengue, y el estilo de piano de Liszt se fusiona con el flamenco-rock.
</p>
<p style="text-align:justify;">
Todo el álbum es una celebración de la música, que demuestra que la genialidad del pasado sigue viva en cada compás de los ritmos modernos y que puede volver a volverse viral.
</p>
</p>
</img></div>
<div class="right-col">
<h1>TIEMPO TROPICAL – RITMO INMORTAL</h1>
<div class="meta-row" id="meta-row">
<span class="pill" id="year-pill">07.11.2025</span>
<span class="pill" id="genre-pill">Género: <strong style="font-weight:700;margin-left:6px;">Classical Crossover / Latin Fusion</strong></span>
</div>
<ol class="tracklist" id="tracklist">
  <li class="track">
    <div class="t-left"><span class="no">01.</span><span class="name">DAME MÁS LUDWIK (BEETHOVEN)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/01._dame_mas_ludwik_-_ludwig_van_beethoven_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">02.</span><span class="name">EL GENIO DEL PIANO (MOZART)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/02._el_genio_del_piano_-_wolfgang_amadeus_mozart_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">03.</span><span class="name">DAME MÁS JOHANN (BACH)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/03._dame_mas_johann_-_johann_sebastian_bach_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">04.</span><span class="name">LAS ABUELAS DEL TIEMPO (JOSEPH HAYDN)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/04._las_abuelas_del_tiempo_joseph_haydn_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">05.</span><span class="name">VIVALDI EN LA DISCO (ANTONIO VIVALDI)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/05._vivaldi_en_la_disco_-_antonio_vivaldi_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">06.</span><span class="name">EL REY DE LAS BALADAS (FRÉDÉRIC FRANÇOIS CHOPIN)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/06._el_rey_de_las_baladas_-_frederic_franois_chopin_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">07.</span><span class="name">EL DIABLO DEL RITMO (NICCOLÒ PAGANINI)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/07._el_diablo_del_ritmo_-_niccol_paganini_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">08.</span><span class="name">EL SHOWMAN DE LOS AÑOS 1800 (FRANZ LISZT)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/08._el_showman_de_los_anos_1800_-_franz_liszt_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">09.</span><span class="name">EL BANQUETE DEL CRESCENDO (ROSSINI)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/09._el_banquete_del_crescendo_-_gioachino_rossini_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
  <li class="track">
    <div class="t-left"><span class="no">10.</span><span class="name">EL PASAPORTE TROPICAL (HOXOH)</span></div>
    <div class="t-audio">
      <audio crossorigin="anonymous" controls preload="none">
        <source src="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/previews/tiempo_tropical_ritmo_inmortal/10._el_pasaporte_tropical_hoxoh_preview.mp3" type="audio/mpeg">
      </audio>
    </div>
  </li>
</ol>
<p><a class="back" href="albums.html">← Volver a todos los álbumes</a></p>
</div>
</article>
</main>
<footer class="site-footer">
<div class="container footer-inner">
<div>© HOXOH MUSIC 2025</div>
<div class="legal">
<a class="chip" href="impressum.html">Aviso Legal</a>
<a class="chip" href="datenschutz.html">Privacidad</a>
<a class="chip" href="cookies.html">Cookies</a>
<a class="chip" href="explizit.html">Contenido Explícito</a>
<a class="chip" href="agb.html">Términos</a>
</div>
</div>
</footer>
<script>
    (function () {
      const cover   = document.querySelector('.album-detail .left-col .cover');
      const metaRow = document.getElementById('meta-row');
      const genreEl = document.getElementById('genre-pill');
      if (!cover || !metaRow || !genreEl) return;

      const srcAttr = cover.getAttribute('src') || '';
      const file    = srcAttr.split('/').pop().split('?')[0].split('#')[0];
      const testURL = 'assets/explizit/' + file + '?v=' + Date.now();

      function insertExplicit() {
        if (metaRow.querySelector('.pill.explicit')) return;
        const pill = document.createElement('span');
        pill.className = 'pill explicit';
        pill.textContent = 'EXPLÍCITO';
        metaRow.insertBefore(pill, genreEl);
      }

      const probe = new Image();
      probe.onload  = () => (probe.naturalWidth > 0 ? insertExplicit() : 0);
      probe.onerror = () => {};
      probe.src = testURL;
    })();
  </script>
<script>
    // Este álbum fue clasificado como NO-EXPLÍCITO
    // Por lo tanto, no se necesita sistema EXPLÍCITO específico por pista
  </script>
<!-- Unified audio footer: path-encoding + single-player + stall-protection -->
<script>
  (function(){
    if (window.__hoxohAudioPatched) return;
    window.__hoxohAudioPatched = true;

    // Pfade mit Sonderzeichen encodieren (TIEMPO TROPICAL – RITMO INMORTAL)
    document.querySelectorAll('.t-audio audio').forEach(a => {
      const s = a.querySelector('source');
      if (!s) return;
      const src = s.getAttribute('src') || '';
      const enc = encodeURI(src);
      if (src !== enc) { s.setAttribute('src', enc); a.load(); }
    });

    const audios = Array.from(document.querySelectorAll('audio'));
    let current = null;

    // 1) Kein Preload am Anfang
    audios.forEach(a => a.preload = 'none');

    // 2) Preload erst nach erster User-Interaktion
    let activated = false;
    function activatePreloadOnce(){
      if (activated) return;
      activated = true;
      audios.forEach(a => a.preload = 'auto');
    }
    document.addEventListener('pointerdown', activatePreloadOnce, { once:true, capture:true });

    // 3) Andere Player stoppen
    function pauseOthers(except){
      for (const a of audios){
        if (a !== except){
          a.pause();
          a.currentTime = 0;
        }
      }
    }

    // 4) Früh-Stall-Schutz
    function addStallProtection(a){
      let retried = false;
      const earlyWindowSec = 5;
      function tryRecover(){
        if (retried) return;
        retried = true;
        const wasMuted = a.muted;
        a.load();
        a.muted = wasMuted;
        a.play().catch(()=>{});
      }
      a.addEventListener('stalled', () => { if (a.currentTime < earlyWindowSec) tryRecover(); });
      a.addEventListener('suspend', () => { if (a.currentTime < earlyWindowSec && a.networkState !== a.NETWORK_IDLE) tryRecover(); });
      a.addEventListener('error',   () => { if (a.currentTime < earlyWindowSec) tryRecover(); });

      let lastT = 0, stuckCnt = 0;
      a.addEventListener('timeupdate', () => {
        if (a.currentTime === lastT) {
          stuckCnt++;
          if (stuckCnt >= 3 && a.currentTime < earlyWindowSec) tryRecover();
        } else {
          stuckCnt = 0;
          lastT = a.currentTime;
        }
      });
    }

    audios.forEach(a => {
      addStallProtection(a);
      a.addEventListener('play', () => {
        if (current !== a) { pauseOthers(a); current = a; }
      });
      a.addEventListener('ended', () => { if (current === a) current = null; });
    });
  })();
  </script>

<script>
(function(){ 
  var container = document.querySelector('.album-detail'); 
  if(!container) return;
  var cover = container.querySelector('.left-col .cover');
  if(!cover) return;
  var originalSrc = cover.getAttribute('src');

  function setCover(src){
    cover.classList.add('is-swapping');
    var img = new Image();
    img.onload = function(){
      cover.src = src;
      requestAnimationFrame(function(){
        cover.classList.remove('is-swapping');
      });
    };
    img.src = src;
  }

  var audios = Array.from(container.querySelectorAll('audio'));
  // Pause other players (non-invasive if already present)
  audios.forEach(function(a){
    a.addEventListener('play', function(){
      audios.forEach(function(b){ if(b!==a) b.pause(); });
      var li = a.closest('li.track');
      if(!li) return;
      var noEl = li.querySelector('.no');
      if(!noEl) return;
      var num = (noEl.textContent || '').replace(/\D/g, '');
      if(!num) return;
      var nn = ('0' + num).slice(-2);
      var nextSrc = 'assets/covers_tracks/06_tiempo_tropical/' + nn + '.jpg';
      setCover(nextSrc);
    }, {passive:true});
    a.addEventListener('pause', function(){
      // if ended event already restored, skip
      if(!a.ended) setCover(originalSrc);
    }, {passive:true});
    a.addEventListener('ended', function(){
      setCover(originalSrc);
    }, {passive:true});
  });
})();
</script>
<script>
window.TRACK_COVER_DIR="https://pub-00345912548b4ae4ac0e4c0047e289f0.r2.dev/covers_tracks/06_tiempo_tropical/";
</script>

<script>
/* === HOXOH Unified Album Script (guarded) — TIEMPO TROPICAL === */
(function(){
  if (window.__hoxohUnifiedApplied) return;
  window.__hoxohUnifiedApplied = true;

  /* 1) Language menu (id="lang") minimal + safe */
  (function(){
    const root = document.getElementById('lang');
    if(!root || root.__langToggleSetup) return;
    root.__langToggleSetup = true;
    const btn  = root.querySelector('.lang-btn');
    const menu = root.querySelector('.lang-menu');
    if(!btn || !menu) return;
    function openM(){ root.classList.add('open'); btn.setAttribute('aria-expanded','true'); }
    function closeM(){ root.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
    btn.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation();
      if(root.classList.contains('open')) closeM(); else openM();
    });
    document.addEventListener('click', function(e){ if(!root.contains(e.target)) closeM(); });
    btn.addEventListener('keydown', function(e){
      if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); e.stopPropagation();
        if(root.classList.contains('open')) closeM(); else openM(); }
      if(e.key === 'Escape'){ closeM(); btn.focus(); }
    });
  })();

  /* Helpers */
  function getLangLabel(es,de,en){
    const lang = (document.documentElement.getAttribute('lang')||'').toLowerCase();
    if (lang.startsWith('de')) return de;
    if (lang.startsWith('en')) return en;
    return es;
  }

  /* 2) Encode audio source paths and single-player + stall protection */
  (function(){
    const audios = Array.from(document.querySelectorAll('audio'));
    if(!audios.length) return;

    audios.forEach(a => {
      const s = a.querySelector('source');
      if (!s) return;
      const src = s.getAttribute('src') || '';
      const enc = encodeURI(src);
      if (src !== enc) { s.setAttribute('src', enc); try{ a.load(); }catch(e){} }
    });

    audios.forEach(a => a.preload = 'none');
    let activated = false;
    function activatePreloadOnce(){
      if (activated) return;
      activated = true;
      audios.forEach(a => a.preload = 'auto');
    }
    document.addEventListener('pointerdown', activatePreloadOnce, { once:true, capture:true });

    let current = null;
    function pauseOthers(except){
      for (const a of audios){
        if (a !== except){
          a.pause();
          a.currentTime = 0;
        }
      }
    }

    function addStallProtection(a){
      let retried = false;
      const earlyWindowSec = 5;
      function tryRecover(){
        if (retried) return;
        retried = true;
        const wasMuted = a.muted;
        try{ a.load(); }catch(e){}
        a.muted = wasMuted;
        a.play().catch(()=>{});
      }
      a.addEventListener('stalled', () => { if (a.currentTime < earlyWindowSec) tryRecover(); });
      a.addEventListener('suspend', () => { if (a.currentTime < earlyWindowSec && a.networkState !== a.NETWORK_IDLE) tryRecover(); });
      a.addEventListener('error',   () => { if (a.currentTime < earlyWindowSec) tryRecover(); });

      let lastT = 0, stuckCnt = 0;
      a.addEventListener('timeupdate', () => {
        if (a.currentTime === lastT) {
          stuckCnt++;
          if (stuckCnt >= 3 && a.currentTime < earlyWindowSec) tryRecover();
        } else {
          stuckCnt = 0;
          lastT = a.currentTime;
        }
      });
    }

    audios.forEach(a => {
      addStallProtection(a);
      a.addEventListener('play', () => { if (current !== a) { pauseOthers(a); current = a; } });
      a.addEventListener('ended', () => { if (current === a) current = null; });
    });
  })();

  /* 3) Album-level explicit pill by file presence */
  (function () {
    const cover   = document.querySelector('.album-detail .left-col .cover');
    const metaRow = document.getElementById('meta-row');
    const genreEl = document.getElementById('genre-pill');
    if (!cover || !metaRow || !genreEl) return;

    const srcAttr = cover.getAttribute('src') || '';
    const file    = srcAttr.split('/').pop().split('?')[0].split('#')[0];
    const testURL = 'assets/explizit/' + file + '?v=' + Date.now();

    function insertExplicit() {
      if (metaRow.querySelector('.pill.explicit')) return;
      const pill = document.createElement('span');
      pill.className = 'pill explicit';
      pill.textContent = getLangLabel('EXPLÍCITO', 'EXPLIZIT', 'EXPLICIT');
      metaRow.insertBefore(pill, genreEl);
    }

    const probe = new Image();
    probe.onload  = () => (probe.naturalWidth > 0 ? insertExplicit() : 0);
    probe.onerror = () => {};
    probe.src = testURL;
  })();

  /* 4) Track-level explicit chip by presence under assets/explizit_tracks/<AlbumTitle> */
  ;(function(){
    const titleEl = document.querySelector('.album-detail h1');
    const list = document.getElementById('tracklist');
    if(!titleEl || !list) return;
    const albumTitle = titleEl.textContent.trim().replace(/\u2014/g,'\u2013');
    const base    = 'assets/explizit_tracks/' + albumTitle + '/';
    const tryExts = ['.png', '.jpg', '.webp'];
    const dashes  = [' - ', ' — ', ' – '];
    const LABEL   = getLangLabel('EXPLÍCITO','EXPLIZIT','EXPLICIT');

    function toTitleCase(s){
      return s.toLowerCase().replace(/\p{L}+/gu, w => w[0].toUpperCase() + w.slice(1));
    }
    function getNo(li){ return (li.querySelector('.no')?.textContent || '').replace(/\D/g,'').padStart(2,'0'); }
    function getName(li){ return (li.querySelector('.name')?.textContent || '').trim(); }

    function buildCandidates(li){
      const no   = getNo(li);
      const name = getName(li);
      const core = (no ? (no + '. ') : '') + name;
      const titleCaseCore = toTitleCase(core);
      return [core, titleCaseCore];
    }

    function insertChip(li){
      if(li.querySelector('.explicit-chip')) return;
      const nameNode = li.querySelector('.t-left .name');
      if(!nameNode) return;
      const chip = document.createElement('span');
      chip.className = 'explicit-chip';
      chip.textContent = LABEL;
      nameNode.after(chip);
    }

    function tryOne(li){
      const candidates = buildCandidates(li);
      const probe = new Image();
      let i = 0, j = 0;
      function next(){
        if(i >= candidates.length) return;
        const url = encodeURI(base + candidates[i] + tryExts[j]) + '?v=' + Date.now();
        probe.onerror = () => { j++; if(j < tryExts.length){ next(); } else { j=0; i++; next(); } };
        probe.onload  = () => { if (probe.naturalWidth > 0) insertChip(li); };
        probe.src = url;
      }
      next();
    }
    Array.from(list.querySelectorAll('li.track')).forEach(tryOne);
  })();

  /* 5) Track-cover swapping driven by window.TRACK_COVER_DIR */
  ;(function(){
    const coverImg=document.querySelector('.album-detail .left-col .cover');
    const tracks=Array.from(document.querySelectorAll('#tracklist li.track'));
    if(!coverImg||!tracks.length)return;
    const albumCoverSrc=coverImg.getAttribute('src')||'';
    const baseDir=(window.TRACK_COVER_DIR||'').trim();
    if(!baseDir) return;

    function swapCover(newSrc){
      if(!newSrc)return;
      const test=new Image();
      const stamp = (newSrc.includes('?')?'&':'?')+'v='+Date.now();
      test.onload=()=>{
        coverImg.classList.add('is-swapping');
        setTimeout(()=>{
          coverImg.src=newSrc+stamp;
          coverImg.onload=()=>coverImg.classList.remove('is-swapping');
        },120);
      };
      test.onerror=()=>{};
      test.src=newSrc+stamp;
    }
    function candidatesByIndex(idx){
      const nn=String(idx).padStart(2,'0');
      return [baseDir+nn+'.jpg', baseDir+nn+'.png', baseDir+nn+'.webp'];
    }

    const audios=Array.from(document.querySelectorAll('li.track audio'));
    function restoreIfNonePlaying(){
      const playing=audios.some(a=>!a.paused&&!a.ended);
      if(!playing) swapCover(albumCoverSrc);
    }
    audios.forEach((audio,i)=>{
      const idx=i+1;
     audio.addEventListener('playing', () => {
        const cands=candidatesByIndex(idx);
        let j=0;(function next(){
          if(j>=cands.length) return;
          const probe=new Image();
          const url=cands[j]+'?v='+Date.now();
          probe.onload=()=>swapCover(cands[j]);
          probe.onerror=()=>{ j++; next(); };
          probe.src=url;
        })();
      });
      audio.addEventListener('pause',restoreIfNonePlaying);
      audio.addEventListener('ended',restoreIfNonePlaying);
    });
  })();
})();
</script>

</body>
</html>







